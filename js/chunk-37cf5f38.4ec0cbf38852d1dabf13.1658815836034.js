(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-37cf5f38"],{"03c1":function(e,t,n){"use strict";n("05d1")},"05d1":function(e,t,n){var c=n("d581");c.__esModule&&(c=c.default),"string"===typeof c&&(c=[[e.i,c,""]]),c.locals&&(e.exports=c.locals);var o=n("499e").default;o("4031f144",c,!0,{sourceMap:!1,shadowMode:!1})},d581:function(e,t,n){var c=n("24fb");t=c(!1),t.push([e.i,"img[data-v-1ef839f1]{width:30%;margin-left:30%}",""]),e.exports=t},ed85:function(e,t,n){"use strict";n.r(t);var c=n("7a23"),o={id:"Dashboard"};function r(e,t,n,r,a,i){var l=Object(c["resolveComponent"])("Header"),u=Object(c["resolveComponent"])("router-view");return Object(c["openBlock"])(),Object(c["createElementBlock"])("div",o,[Object(c["createVNode"])(l),Object(c["createElementVNode"])("main",null,[Object(c["createVNode"])(u)])])}var a=n("1da1"),i=(n("96cf"),n("3786")),l=n("7864"),u=function(e){return Object(c["pushScopeId"])("data-v-1ef839f1"),e=e(),Object(c["popScopeId"])(),e},s=u((function(){return Object(c["createElementVNode"])("i",{class:"el-icon-user-solid"},null,-1)})),d=Object(c["createTextVNode"])("PDF匯出"),b=Object(c["createTextVNode"])("Logout");function p(e,t,n,o,r,a){var i=Object(c["resolveComponent"])("Timer"),l=Object(c["resolveComponent"])("el-button"),u=Object(c["resolveComponent"])("el-popover"),p=Object(c["resolveComponent"])("Menu");return Object(c["openBlock"])(),Object(c["createElementBlock"])("header",{id:"Header",class:Object(c["normalizeClass"])({animation:o.firstEnter})},[Object(c["createVNode"])(i),Object(c["createElementVNode"])("div",{class:"title",style:Object(c["normalizeStyle"])({height:"".concat(o.themeColor.frontStage_title_height,"px"),width:"".concat(o.themeColor.frontStage_title_width,"px"),fontSize:"".concat(o.themeColor.frontStage_title_fontSize,"px")})},Object(c["toDisplayString"])(o.routeTitle),5),Object(c["createVNode"])(u,{placement:"bottom-end",trigger:"click","popper-class":"userInfo front",visible:o.visible,"onUpdate:visible":t[0]||(t[0]=function(e){return o.visible=e})},{reference:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(l,{class:"avatar",type:"text"},{default:Object(c["withCtx"])((function(){return[s,Object(c["createElementVNode"])("p",null,Object(c["toDisplayString"])(o.display_name),1)]})),_:1})]})),default:Object(c["withCtx"])((function(){return[o.allowEditDashboard?(Object(c["openBlock"])(),Object(c["createBlock"])(l,{key:0,icon:"el-icon-edit",onClick:o.toggleEdit},{default:Object(c["withCtx"])((function(){return[Object(c["createTextVNode"])(Object(c["toDisplayString"])(o.editting?"關閉編輯":"開啟編輯"),1)]})),_:1},8,["onClick"])):Object(c["createCommentVNode"])("",!0),Object(c["createVNode"])(l,{icon:"el-icon-video-camera-solid",onClick:o.toggleSwipe},{default:Object(c["withCtx"])((function(){return[Object(c["createTextVNode"])(Object(c["toDisplayString"])(o.swiping?"關閉輪播":"開始輪播"),1)]})),_:1},8,["onClick"]),o.isPdfExpoerted?(Object(c["openBlock"])(),Object(c["createBlock"])(l,{key:1,icon:"el-icon-download",onClick:o.downloadPDF},{default:Object(c["withCtx"])((function(){return[d]})),_:1},8,["onClick"])):Object(c["createCommentVNode"])("",!0),Object(c["createVNode"])(l,{icon:"el-icon-lock",onClick:o.logout},{default:Object(c["withCtx"])((function(){return[b]})),_:1},8,["onClick"])]})),_:1},8,["visible"]),Object(c["createVNode"])(p,{menuList:o.menuList},null,8,["menuList"])],2)}n("7db0"),n("d3b7");var f=n("5502"),m=n("a18c"),j=(n("99af"),{class:"menu"}),O=Object(c["createElementVNode"])("button",null,[Object(c["createElementVNode"])("span")],-1);function v(e,t,n,o,r,a){var i=Object(c["resolveComponent"])("Node"),l=Object(c["resolveComponent"])("el-submenu"),u=Object(c["resolveComponent"])("el-menu"),s=Object(c["resolveComponent"])("el-popover");return Object(c["openBlock"])(),Object(c["createElementBlock"])("div",j,[Object(c["createVNode"])(s,{placement:"bottom-end",trigger:"click","popper-class":"dashBoardMenu",visible:o.visible,"onUpdate:visible":t[0]||(t[0]=function(e){return o.visible=e}),width:"auto"},{reference:Object(c["withCtx"])((function(){return[O]})),default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(u,{mode:"horizontal"},{default:Object(c["withCtx"])((function(){return[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(n.menuList,(function(e,t){return Object(c["openBlock"])(),Object(c["createElementBlock"])(c["Fragment"],{key:e.id},[1===e.menuType&&e.isVisible?(Object(c["openBlock"])(),Object(c["createBlock"])(l,{key:0,index:"".concat(t+2),"popper-append-to-body":!1,"show-timeout":100,"hide-timeout":100,class:Object(c["normalizeClass"])({active:o.checkPage(e.menuCode)})},{title:Object(c["withCtx"])((function(){return[Object(c["createTextVNode"])(Object(c["toDisplayString"])(e.title),1)]})),default:Object(c["withCtx"])((function(){return[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(e.children,(function(e,n){return Object(c["openBlock"])(),Object(c["createElementBlock"])(c["Fragment"],{key:e.id},[e.isVisible?(Object(c["openBlock"])(),Object(c["createBlock"])(i,{key:0,index:"".concat(t+2,"-").concat(n+1),nodeData:e,onClick:o.closeMenu},null,8,["index","nodeData","onClick"])):Object(c["createCommentVNode"])("",!0)],64)})),128))]})),_:2},1032,["index","class"])):e.isVisible?(Object(c["openBlock"])(),Object(c["createBlock"])(i,{key:1,index:"".concat(t+2),nodeData:e,onClick:o.closeMenu},null,8,["index","nodeData","onClick"])):Object(c["createCommentVNode"])("",!0)],64)})),128))]})),_:1})]})),_:1},8,["visible"])])}n("c740"),n("b0c0");function h(e,t,n,o,r,a){var i=Object(c["resolveComponent"])("el-menu-item");return Object(c["openBlock"])(),Object(c["createBlock"])(i,{class:Object(c["normalizeClass"])(o.checkPage),index:n.index},{default:Object(c["withCtx"])((function(){return[Object(c["createElementVNode"])("a",{onClick:t[0]||(t[0]=function(){return o.linkClick&&o.linkClick.apply(o,arguments)})},Object(c["toDisplayString"])(n.nodeData.title),1)]})),_:1},8,["class","index"])}n("ac1f"),n("00b4");var k={name:"FrontMenuNode",props:{index:String,nodeData:{type:Object,defult:null}},setup:function(e){var t=e?e.nodeData:{},n=Object(f["b"])(),o=Object(c["computed"])((function(){return n.state.dashboard.frameworkcount})),r=Object(c["computed"])((function(){var e=m["a"].currentRoute.value.name;return t.menuCode===e?"active":""})),a=function(e){var t=/http:|https:/;return t.test(e)},i=function(){if(o.value>0)Object(l["b"])({type:"error",message:"尚有Framework未儲存"});else switch(t.openType){case 1:m["a"].push({path:t.path});break;case 2:a(t.path)?window.open(t.path):m["a"].push({path:t.path});break;case 3:m["a"].push({path:"/dashboard/iframe"});break;default:break}};return{checkPage:r,linkClick:i,checkPath:a}}},g=n("6b0d"),w=n.n(g);const C=w()(k,[["render",h]]);var x=C,B={name:"DashboardMenu",components:{Node:x},props:{menuList:{type:Array,default:null}},setup:function(){var e=Object(c["ref"])("1"),t=Object(c["ref"])(!1),n=function(){t.value=!1},o=function(e){var t=m["a"].currentRoute.value.matched;return t.findIndex((function(t){return t.name===e}))>-1};return{activeIndex:e,visible:t,closeMenu:n,checkPage:o}}};const y=w()(B,[["render",v]]);var E=y,N={class:"time"},V=Object(c["createElementVNode"])("i",{class:"el-icon-date"},null,-1);function _(e,t,n,o,r,a){return Object(c["openBlock"])(),Object(c["createElementBlock"])("div",N,[V,Object(c["createElementVNode"])("p",null,Object(c["toDisplayString"])(o.time),1)])}var D=n("c1df"),S=n.n(D),I={name:"Timer",setup:function(){var e,t=Object(f["b"])(),n=Object(c["computed"])((function(){return t.state.app.themeColor.frontStage_time_format})),o=Object(c["ref"])(S()().format(n.value));return Object(c["onMounted"])((function(){e=setInterval((function(){o.value=S()().format(n.value)}),1e3)})),Object(c["onBeforeUnmount"])((function(){clearInterval(e)})),{time:o}}};const T=w()(I,[["render",_]]);var M=T,R=n("d227"),L=n("c0e9"),P=n.n(L),F=n("8baf"),z={name:"frontEndHeader",components:{Menu:E,Timer:M},setup:function(){var e,t=Object(c["ref"])(!1),n=Object(c["ref"])(!1),o=Object(f["b"])(),r=Object(c["computed"])((function(){return o.state.dashboard.editting})),u=Object(c["computed"])((function(){return o.state.app.themeColor})),s=Object(c["computed"])((function(){return o.state.user.user})),d=s.value.display_name,b=Object(c["computed"])((function(){return o.state.user.front_permissions})),p=o.state.user,j=p.allowEditDashboard,O=p.isPdfExpoerted,v=Object(c["ref"])(!1),h=Object(c["computed"])((function(){var e=o.state.menu.frontMenuList;return k(e)})),k=function(e){var t,n,c={},o=[];for(n=0;n<e.length;n++){c[e[n].id]=n,e[n].children=[];var r=b.value.find((function(t){return t.menuId===e[n].id}));e[n].isVisible=!!r&&r.isVisible}for(n=0;n<e.length;n++)t=e[n],0!==t.parentId&&e[c[t.parentId]]?e[c[t.parentId]].children.push(t):o.push(t);return o},g=Object(c["computed"])((function(){return m["a"].currentRoute.value.meta.title})),w=Object(c["computed"])((function(){return m["a"].currentRoute.value.meta.interval})),C=function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l["c"].confirm("確認登出系統？","提醒",{confirmButtonText:"確認",cancelButtonText:"取消",closeOnClickModal:!1,cancelButtonClass:"cancelButton",confirmButtonClass:"confirmButton",type:"warning"});case 3:return e.next=5,i["a"].logout();case 5:Object(l["c"])({message:"已登出成功",type:"success"}),localStorage.clear(),o.dispatch("panels/clearAllPanels"),m["a"].push({path:"/login"}),e.next=13;break;case 11:e.prev=11,e.t0=e["catch"](0);case 13:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}(),x=function(){n.value=!1,o.dispatch("dashboard/setEditting",!r.value)},B=function t(){e&&(clearTimeout(e),e=null),v.value&&(e=setTimeout(Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(R["a"])();case 2:t();case 3:case"end":return e.stop()}}),e)}))),w.value))},y=function(){n.value=!1,v.value=!v.value,B()},E=function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t,c,o,r,a,i,l,u,s,d,b,p,f,j;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n.value=!1,t=m["a"].currentRoute.value.meta.title,c=document.getElementById("app"),o=c.querySelectorAll("iframe"),r=0;case 5:if(!(r<o.length)){e.next=24;break}return a=o[r].contentWindow.document.getElementById("app"),e.prev=7,e.next=10,P()(a);case 10:i=e.sent,l=i.toDataURL("image/jpeg",1),u=o[r].parentNode,u.classList.add("fakeIframe"),s=document.createElement("img"),s.src=l,u.append(s),e.next=21;break;case 19:e.prev=19,e.t0=e["catch"](7);case 21:r++,e.next=5;break;case 24:return e.next=26,P()(c);case 26:for(d=e.sent,b=d.toDataURL("image/jpeg",1),p=new F["a"]("l","",[d.width,d.height]),p.addImage(b,"JPEG",0,0,d.width,d.height),p.save("".concat(t,".pdf")),f=0;f<o.length;f++)j=o[f].parentNode,j.childNodes[1].remove();case 32:case"end":return e.stop()}}),e,null,[[7,19]])})));return function(){return e.apply(this,arguments)}}();return Object(c["onBeforeUnmount"])((function(){clearTimeout(e),e=null,o.dispatch("dashboard/setEditting",!1)})),Object(c["onMounted"])((function(){t.value=!0,setTimeout((function(){t.value=!1}),1500)})),{editting:r,themeColor:u,visible:n,logout:C,menuList:h,display_name:d,routeTitle:g,toggleEdit:x,toggleSwipe:y,swiping:v,allowEditDashboard:j,isPdfExpoerted:O,downloadPDF:E,firstEnter:t}}};n("03c1");const U=w()(z,[["render",p],["__scopeId","data-v-1ef839f1"]]);var H=U,A=H,J={name:"Dashboard",components:{Header:A,ElMessage:l["b"]},setup:function(){var e=function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i["a"].autoRefresh();case 3:t=e.sent,t.access_token&&localStorage.setItem("access_token",t.access_token),e.next=9;break;case 7:e.prev=7,e.t0=e["catch"](0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return Object(c["onMounted"])((function(){window.refreshTokenInterval=setInterval(e,48e4)})),Object(c["onBeforeUnmount"])((function(){clearInterval(window.refreshTokenInterval)})),{}}};const q=w()(J,[["render",r]]);var G=q;t["default"]=G}}]);