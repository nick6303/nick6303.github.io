(self["webpackChunkcontrol_center"]=self["webpackChunkcontrol_center"]||[]).push([[8560],{12009:function(e,t,l){"use strict";l.r(t);var n=l(31601),a=l.n(n),o=l(76314),r=l.n(o),i=r()(a());i.push([e.id,".panelContent.EditTrend,.panelContent.EditTrend .contentWrapper{height:100%}.panelContent.EditTrend .contentWrapper .el-form-item.noFlex{margin-right:0!important}.panelContent.EditTrend .contentWrapper .el-form-item.apiurl{position:relative;z-index:99}.panelContent.EditTrend .contentWrapper .el-form-item.apiurl .SearchData{width:100%}.panelContent.EditTrend .contentWrapper .el-form-item .transform{width:150px!important}.panelContent.EditTrend .contentWrapper .el-form-item .el-form-item__label{width:100px}.panelContent.EditTrend .contentWrapper .el-form-item .el-form-item__content{display:flex;align-items:center}.panelContent.EditTrend .contentWrapper .el-form-item.transform .el-form-item__content .el-select{width:150px!important}.panelContent.EditTrend .contentWrapper .el-form-item.transform .el-form-item__content .el-input:not(.el-input--suffix){flex:1}.panelContent.EditTrend .contentWrapper .row{width:100%;position:relative;z-index:1}.panelContent.EditTrend .contentWrapper .row .el-form-item{align-items:center}.panelContent.EditTrend .contentWrapper .row .el-form-item:not(:last-child){margin-right:15px}.panelContent.EditTrend .contentWrapper .tableWrapper{margin:0 0 20px;position:relative;z-index:0}.panelContent.EditTrend .contentWrapper .el-radio-group:not(:last-child){margin:0 10px 0 0}.panelContent.EditTrend .contentWrapper .el-radio-group .el-radio-button i{font-size:18px}.panelContent.EditTrend .contentWrapper .toolTipBtn{margin:10px 5px}.panelContent.EditTrend .contentWrapper .refreshApi{height:64px}.panelContent.EditTrend .contentWrapper .plotBands{flex-direction:column;align-items:flex-start}.panelContent.EditTrend .contentWrapper .plotBands .el-form-item__label{display:flex;align-items:center;margin:10px 0 10px}.panelContent.EditTrend .contentWrapper .plotBands .el-form-item__label .el-button{margin:0 5px}.panelContent.EditTrend .contentWrapper .plotBands .el-form-item__content,.panelContent.EditTrend .contentWrapper .plotBands ul{width:100%}.panelContent.EditTrend .contentWrapper .plotBands .list{width:100%;border-bottom:1px solid #ccc;padding:5px 0;display:flex;align-items:center}.panelContent.EditTrend .contentWrapper .plotBands .list:first-child{border-top:1px solid #ccc}.panelContent.EditTrend .contentWrapper .plotBands .list .deletePlotBands{padding:5px 7px;margin:5px 5px 5px 0}.panelContent.EditTrend .contentWrapper .plotBands .list h4{white-space:nowrap}.panelContent.EditTrend .contentWrapper .plotBands .list .row{align-items:center;width:auto}.panelContent.EditTrend .contentWrapper .plotBands .list .row .el-slider{width:200px}.panelContent.EditTrend .contentWrapper .plotBands .list .row .el-input{margin:0 5px}.panelContent.EditTrend .contentWrapper .plotBands .list .row .el-input__inner{padding:0 5px}.panelContent.EditTrend .contentWrapper .plotBands .list .row .el-color-picker{margin:0 5px}.panelContent.EditTrend .contentWrapper .plotBands .list .row p{white-space:nowrap}.panelContent.EditTrend .contentWrapper .plotBands{flex-direction:row}.panelContent.EditTrend .contentWrapper .plotBands .el-form-item__label{width:auto!important}.panelContent.EditTrend .contentWrapper .plotBands ul{padding-left:15px}.panelContent.EditTrend .contentWrapper .plotBands ul .list:first-child{border-top:none}.panelContent.EditTrend .contentWrapper .plotBands ul .list .deletePlotBands{margin-right:15px}.panelContent.EditTrend .contentWrapper .plotBands ul .list .row .el-input{margin:0 12px}.panelContent.EditTrend .contentWrapper .plotBands ul .list .row .ColorPicker,.panelContent.EditTrend .contentWrapper .plotBands ul .list .row p{margin-left:10px}",""]),t["default"]=i},23314:function(e,t,l){var n=l(12009);n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);var a=l(68459).A;a("4844166d",n,!0,{sourceMap:!1,shadowMode:!1})},78560:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return B}});var n=l(56768),a=l(24232);const o={class:"panelContent EditTrend"},r={class:"contentWrapper",ref:"contentWrapper"},i={class:"row"},p={class:"row"},d={class:"row"},s={class:"row"},u={class:"row"},c={class:"buttonWrapper"};function m(e,t,l,m,f,b){const g=(0,n.g2)("SearchData"),k=(0,n.g2)("el-form-item"),h=(0,n.g2)("TableWrapper"),w=(0,n.g2)("el-divider"),F=(0,n.g2)("el-option"),x=(0,n.g2)("el-select"),C=(0,n.g2)("el-table-column"),W=(0,n.g2)("el-table"),_=(0,n.g2)("el-popover"),E=(0,n.g2)("el-input"),V=(0,n.g2)("TransformItem"),v=(0,n.g2)("FontFamily"),T=(0,n.g2)("FontSizeEdit"),y=(0,n.g2)("ColorPicker"),D=(0,n.g2)("el-radio-button"),B=(0,n.g2)("el-radio-group"),A=(0,n.g2)("el-button"),L=(0,n.g2)("el-switch"),S=(0,n.g2)("el-checkbox"),U=(0,n.g2)("RefreshTime"),z=(0,n.g2)("el-form");return(0,n.uX)(),(0,n.CE)("div",o,[(0,n.Lk)("div",r,[(0,n.bF)(z,{class:"contentInner",ref:"editForm",model:m.formData,rules:m.rules,"label-width":"110px"},{default:(0,n.k6)(()=>[(0,n.bF)(k,{class:"apiurl",label:"資料來源",prop:"apiurl"},{default:(0,n.k6)(()=>[(0,n.bF)(g,{modelValue:m.formData.apiurl,"onUpdate:modelValue":t[0]||(t[0]=e=>m.formData.apiurl=e),onUpdate:m.getData},null,8,["modelValue","onUpdate"])]),_:1}),m.tableData?((0,n.uX)(),(0,n.CE)(n.FK,{key:0},[(0,n.bF)(h,{tableType:"small",tableHeight:m.tableHeight,tableWidth:m.tableWidth,tableData:m.tableData,columnSetting:m.columnSetting,listLoading:m.loading,showPagination:!1},null,8,["tableHeight","tableWidth","tableData","columnSetting","listLoading"]),(0,n.bF)(w,{"content-position":"left"},{default:(0,n.k6)(()=>[...t[13]||(t[13]=[(0,n.Lk)("b",null,"資料處理",-1)])]),_:1}),(0,n.Lk)("div",i,[(0,n.bF)(k,{label:"目標參數",required:"",error:m.column?"":"此項必填"},{default:(0,n.k6)(()=>[(0,n.bF)(x,{modelValue:m.column,"onUpdate:modelValue":t[1]||(t[1]=e=>m.column=e),placeholder:"select Data"},{default:(0,n.k6)(()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(Object.keys(m.searchResult),e=>((0,n.uX)(),(0,n.Wv)(F,{label:e,value:e,key:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["error"]),(0,n.bF)(k,null,{label:(0,n.k6)(()=>[t[15]||(t[15]=(0,n.Lk)("p",null,"資料選擇",-1)),(0,n.bF)(_,{width:200,placement:"bottom-start",trigger:"hover"},{reference:(0,n.k6)(()=>[...t[14]||(t[14]=[(0,n.Lk)("i",{class:"el-icon-question toolTipBtn"},null,-1)])]),default:(0,n.k6)(()=>[(0,n.bF)(W,{data:m.directions},{default:(0,n.k6)(()=>[(0,n.bF)(C,{label:"輸入",width:60},{default:(0,n.k6)(e=>[(0,n.Lk)("code",null,(0,a.toDisplayString)(e.row.input),1)]),_:1}),(0,n.bF)(C,{label:"範例",width:100},{default:(0,n.k6)(e=>[(0,n.Lk)("code",null,(0,a.toDisplayString)(e.row.example),1)]),_:1})]),_:1},8,["data"])]),_:1})]),default:(0,n.k6)(()=>[(0,n.bF)(E,{modelValue:m.formData.resort,"onUpdate:modelValue":t[2]||(t[2]=e=>m.formData.resort=e),type:"number"},{prepend:(0,n.k6)(()=>[...t[16]||(t[16]=[(0,n.eW)("選擇第",-1)])]),append:(0,n.k6)(()=>[...t[17]||(t[17]=[(0,n.eW)("個資料",-1)])]),_:1},8,["modelValue"])]),_:1})]),m.formData.onlyShowArrow?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.Wv)(V,{key:0,transform:m.formData.transform,mathString:m.formData.mathString,onUpdate:m.updateTransform},null,8,["transform","mathString","onUpdate"]))],64)):(0,n.Q3)("",!0),m.column?((0,n.uX)(),(0,n.CE)(n.FK,{key:1},[(0,n.bF)(w,{"content-position":"left"},{default:(0,n.k6)(()=>[...t[18]||(t[18]=[(0,n.Lk)("b",null,"文字造型",-1)])]),_:1}),(0,n.Lk)("div",p,[(0,n.bF)(k,{label:"文字字型"},{default:(0,n.k6)(()=>[(0,n.bF)(v,{modelValue:m.formData.fontFamily,"onUpdate:modelValue":t[3]||(t[3]=e=>m.formData.fontFamily=e)},null,8,["modelValue"])]),_:1}),(0,n.bF)(k,{class:"noFlex",label:"文字大小"},{default:(0,n.k6)(()=>[(0,n.bF)(T,{modelValue:m.formData.fontSize,"onUpdate:modelValue":t[4]||(t[4]=e=>m.formData.fontSize=e)},null,8,["modelValue"])]),_:1}),(0,n.bF)(k,{class:"noFlex",label:"文字顏色"},{default:(0,n.k6)(()=>[(0,n.bF)(y,{modelValue:m.formData.color,"onUpdate:modelValue":t[5]||(t[5]=e=>m.formData.color=e)},null,8,["modelValue"])]),_:1}),(0,n.bF)(w,{direction:"vertical"}),(0,n.bF)(k,{class:"btn noFlex"},{default:(0,n.k6)(()=>[(0,n.bF)(B,{modelValue:m.formData.textAlign,"onUpdate:modelValue":t[6]||(t[6]=e=>m.formData.textAlign=e),size:"small"},{default:(0,n.k6)(()=>[(0,n.bF)(D,{label:"flex-start",title:"水平靠左"},{default:(0,n.k6)(()=>[...t[19]||(t[19]=[(0,n.Lk)("i",{class:"icon-paragraph-left"},null,-1)])]),_:1}),(0,n.bF)(D,{label:"center",title:"水平置中"},{default:(0,n.k6)(()=>[...t[20]||(t[20]=[(0,n.Lk)("i",{class:"icon-paragraph-center"},null,-1)])]),_:1}),(0,n.bF)(D,{label:"flex-end",title:"水平靠右"},{default:(0,n.k6)(()=>[...t[21]||(t[21]=[(0,n.Lk)("i",{class:"icon-paragraph-right"},null,-1)])]),_:1}),(0,n.bF)(D,{label:"space-between",title:"水平均分"},{default:(0,n.k6)(()=>[...t[22]||(t[22]=[(0,n.Lk)("i",{class:"icon-paragraph-justify"},null,-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),(0,n.bF)(w,{direction:"vertical"}),(0,n.bF)(k,{class:"btn noFlex"},{default:(0,n.k6)(()=>[(0,n.bF)(B,{modelValue:m.formData.textVerticle,"onUpdate:modelValue":t[7]||(t[7]=e=>m.formData.textVerticle=e),size:"small"},{default:(0,n.k6)(()=>[(0,n.bF)(D,{label:"flex-start"},{default:(0,n.k6)(()=>[...t[23]||(t[23]=[(0,n.Lk)("i",{class:"icon-align-top"},null,-1)])]),_:1}),(0,n.bF)(D,{label:"center"},{default:(0,n.k6)(()=>[...t[24]||(t[24]=[(0,n.Lk)("i",{class:"icon-align-vertical-middle"},null,-1)])]),_:1}),(0,n.bF)(D,{label:"flex-end"},{default:(0,n.k6)(()=>[...t[25]||(t[25]=[(0,n.Lk)("i",{class:"icon-align-bottom"},null,-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),m.formData.onlyShowArrow?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.Wv)(k,{key:0,class:"plotBands"},{label:(0,n.k6)(()=>[t[27]||(t[27]=(0,n.Lk)("p",null,"標示特定範圍",-1)),(0,n.bF)(A,{type:"primary",plain:"",size:"small",onClick:m.addPlotBands},{default:(0,n.k6)(()=>[...t[26]||(t[26]=[(0,n.Lk)("i",{class:"el-icon-plus"},null,-1)])]),_:1},8,["onClick"])]),default:(0,n.k6)(()=>[(0,n.Lk)("ul",null,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(m.formData.plotBands,(e,l)=>((0,n.uX)(),(0,n.CE)("li",{class:"list",key:l},[(0,n.bF)(A,{class:"deletePlotBands",type:"danger",plain:"",size:"small",onClick:e=>m.deletePlotBands(l)},{default:(0,n.k6)(()=>[...t[28]||(t[28]=[(0,n.Lk)("i",{class:"el-icon-close"},null,-1)])]),_:1},8,["onClick"]),(0,n.Lk)("h4",null,(0,a.toDisplayString)(`範圍${l+1}：`),1),(0,n.Lk)("div",d,[t[29]||(t[29]=(0,n.Lk)("p",null,"範圍 ",-1)),(0,n.bF)(E,{type:"number",modelValue:e.from,"onUpdate:modelValue":t=>e.from=t,modelModifiers:{number:!0},size:"small"},null,8,["modelValue","onUpdate:modelValue"]),t[30]||(t[30]=(0,n.eW)("至 ",-1)),(0,n.bF)(E,{type:"number",modelValue:e.to,"onUpdate:modelValue":t=>e.to=t,modelModifiers:{number:!0},size:"small"},null,8,["modelValue","onUpdate:modelValue"])]),(0,n.Lk)("div",s,[t[31]||(t[31]=(0,n.Lk)("p",null,", 顏色 ",-1)),(0,n.bF)(y,{modelValue:e.color,"onUpdate:modelValue":t=>e.color=t,"show-alpha":""},null,8,["modelValue","onUpdate:modelValue"])])]))),128))])]),_:1})),(0,n.bF)(w,{"content-position":"left"},{default:(0,n.k6)(()=>[...t[32]||(t[32]=[(0,n.eW)("箭頭設定",-1)])]),_:1}),(0,n.Lk)("div",u,[(0,n.bF)(k,{class:"noFlex",label:"顯示箭頭"},{default:(0,n.k6)(()=>[(0,n.bF)(L,{modelValue:m.formData.showArrow,"onUpdate:modelValue":t[8]||(t[8]=e=>m.formData.showArrow=e),"active-text":"是","inactive-text":"否"},null,8,["modelValue"])]),_:1}),m.formData.showArrow?((0,n.uX)(),(0,n.CE)(n.FK,{key:0},[(0,n.bF)(k,{class:"iconType",label:"箭頭樣式"},{default:(0,n.k6)(()=>[(0,n.bF)(x,{modelValue:m.formData.arrowIcon,"onUpdate:modelValue":t[9]||(t[9]=e=>m.formData.arrowIcon=e),teleported:!1},{default:(0,n.k6)(()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(m.iconList,e=>((0,n.uX)(),(0,n.Wv)(F,{key:e,value:e,style:{display:"flex","align-items":"center"}},{default:(0,n.k6)(()=>[(0,n.Lk)("i",{class:(0,a.normalizeClass)(e),style:{"font-size":"22px","margin-right":"10px",padding:"3px 0 0"}},null,2),(0,n.eW)((0,a.toDisplayString)(e),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,n.bF)(k,{class:"noFlex",label:"顏色-上升"},{default:(0,n.k6)(()=>[(0,n.bF)(y,{modelValue:m.formData.upColor,"onUpdate:modelValue":t[10]||(t[10]=e=>m.formData.upColor=e)},null,8,["modelValue"])]),_:1}),(0,n.bF)(k,{class:"noFlex",label:"顏色-下降"},{default:(0,n.k6)(()=>[(0,n.bF)(y,{modelValue:m.formData.downColor,"onUpdate:modelValue":t[11]||(t[11]=e=>m.formData.downColor=e)},null,8,["modelValue"])]),_:1}),(0,n.bF)(w,{direction:"vertical"}),(0,n.bF)(k,{class:"noFlex"},{default:(0,n.k6)(()=>[(0,n.bF)(S,{modelValue:m.formData.onlyShowArrow,"onUpdate:modelValue":t[12]||(t[12]=e=>m.formData.onlyShowArrow=e)},{default:(0,n.k6)(()=>[...t[33]||(t[33]=[(0,n.eW)("只顯示箭頭",-1)])]),_:1},8,["modelValue"])]),_:1})],64)):(0,n.Q3)("",!0)]),(0,n.bF)(w,{"content-position":"left"},{default:(0,n.k6)(()=>[...t[34]||(t[34]=[(0,n.eW)("更新設定",-1)])]),_:1}),(0,n.bF)(U,{propRefresh:m.refreshApi,onUpdateRefreshApi:m.updateRefreshApi},null,8,["propRefresh","onUpdateRefreshApi"])],64)):(0,n.Q3)("",!0)]),_:1},8,["model","rules"])],512),(0,n.Lk)("div",c,[(0,n.bF)(A,{type:"danger",onClick:m.closePanel},{default:(0,n.k6)(()=>[...t[35]||(t[35]=[(0,n.eW)("取消",-1)])]),_:1},8,["onClick"]),(0,n.bF)(A,{type:"success",onClick:m.checkValidate},{default:(0,n.k6)(()=>[...t[36]||(t[36]=[(0,n.Lk)("span",null,"儲存",-1)])]),_:1},8,["onClick"])])])}l(44114),l(18111),l(61701);var f=l(90144),b=l(7118),g=l(51219),k=l(78626),h=l(77187),w=l(53827),F=l(43988),x=l(42497),C=l(69481),W=l(10406),_=l(7681);const E=["el-icon-top","icon-trend"],V=[{prop:-1,label:"最後一個"},{prop:1,label:"第一個"}],v=[{input:1,example:"第1個"},{input:2,example:"第2個"},{input:-1,example:"倒數第1個"},{input:-2,example:"倒數第2個"}];var T={name:"EditTrend",components:{RefreshTime:W.A,SearchData:F.A,TransformItem:C.A,FontFamily:x.A},props:{configProps:{type:Object,default:null}},setup(e,{emit:t}){const{info:l}=e.configProps??{},a=l.parameter.trendData?l.parameter.trendData:l.parameter,o=l.refreshApi?l.refreshApi:{isEnabled:!1,time:1},r=(0,f.ref)(!1),i=(0,f.ref)(null),p=(0,f.ref)(null),d=(0,f.ref)(void 0),s=(0,f.ref)(0),u=(0,f.ref)(null),c=(0,f.ref)({}),m=(0,f.reactive)({apiurl:a.apiurl||"",color:a.color||"#000",showArrow:a.showArrow||!1,arrowIcon:a.arrowIcon||"el-icon-top",upColor:a.upColor||"",downColor:a.downColor||"",fontSize:a.fontSize||"16px",fontFamily:a.fontFamily||"",textAlign:a.textAlign||"flex-start",textVerticle:a.textVerticle||"center",plotBands:a.plotBands||[],resort:a.resort||1,transform:a.transform||"",mathString:a.mathString||"",onlyShowArrow:a.onlyShowArrow||!1}),F=(0,f.reactive)({isEnabled:o.isEnabled,time:o.time}),x=(0,f.ref)(a.column?a.column[0]:""),C=(0,b.Q4)(m),W=(0,n.EW)(()=>Object.keys(c.value).map(e=>({prop:e,label:e}))),T=()=>{i.value.validate(e=>{e&&x.value&&y()})},y=async()=>{const e=(0,k.cloneDeep)(l);Object.assign(e,{parameter:{...m,column:[x.value]},refreshApi:F});try{let l,n="資料更新成功";e.id?l=await _.A.updatePartOf(e,e.id):(l=await _.A.addItem(e),n="資料新增成功"),(0,g.nk)({type:"success",message:n}),t("event-emit",{name:"refresh-page",props:l}),D()}catch{}},D=()=>{t("close")},B=()=>{m.plotBands.push({color:(0,f.ref)(null),from:(0,f.ref)(0),to:(0,f.ref)(0)})},A=e=>{m.plotBands.splice(e,1)},L=async e=>{if(e){r.value=!0;try{i.value&&i.value.validate();const t=(0,k.cloneDeep)(e),l=await h.A.getData(t);c.value=(0,w.G)(l),u.value=l.length>5?l.slice(0,5):l}catch{u.value=[],(0,g.nk)({type:"error",message:"取得資料失敗"})}finally{r.value=!1}}},S=()=>{d.value=p.value.offsetHeight-400,s.value=.9*window.innerWidth-38},U=e=>{const{isEnabled:t,time:l}=e;F.isEnabled=t,F.time=l},z=e=>{const{transform:t,mathString:l}=e;m.transform=t,m.mathString=l};return(0,n.KC)(()=>{L(a.apiurl)}),(0,n.sV)(()=>{S()}),{loading:r,iconList:E,closePanel:D,rules:C,editForm:i,formData:m,checkValidate:T,columnSetting:W,searchResult:c,column:x,tableData:u,getData:L,tableHeight:d,tableWidth:s,contentWrapper:p,refreshApi:F,updateRefreshApi:U,addPlotBands:B,deletePlotBands:A,resortList:V,directions:v,updateTransform:z}}},y=(l(23314),l(71241));const D=(0,y.A)(T,[["render",m]]);var B=D}}]);