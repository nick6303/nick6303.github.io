(self["webpackChunkcontrol_center"]=self["webpackChunkcontrol_center"]||[]).push([[4872],{48668:function(e,a,l){"use strict";l.r(a);var t=l(31601),n=l.n(t),o=l(76314),r=l.n(o),i=r()(n());i.push([e.id,".panelContent.EditCmdParams,.panelContent.EditCmdParams .contentWrapper{height:100%}.panelContent.EditCmdParams .contentWrapper .el-form-item{position:relative;z-index:1}.panelContent.EditCmdParams .contentWrapper .el-form-item.defaultFirstOption .el-checkbox{margin-right:10px}.panelContent.EditCmdParams .contentWrapper .el-form-item.defaultFirstOption .el-checkbox__label{display:flex;align-items:center}.panelContent.EditCmdParams .contentWrapper .el-form-item.defaultFirstOption .el-input-number{margin:0 5px;width:80px}.panelContent.EditCmdParams .contentWrapper .el-form-item .row{align-items:center}.panelContent.EditCmdParams .contentWrapper .el-form-item .row .el-button{margin-left:0;font-size:18px}.panelContent.EditCmdParams .contentWrapper .tableWrapper{position:relative;padding-bottom:70px;border:none;z-index:0}.panelContent.EditCmdParams .contentWrapper .row{position:relative;z-index:0}.panelContent.EditCmdParams .contentWrapper .row .el-form-item{align-items:center}.panelContent.EditCmdParams .contentWrapper .SearchData{width:100%;position:relative;z-index:1}.panelContent.EditCmdParams .contentWrapper .el-empty{padding:0}.panelContent.EditCmdParams .contentWrapper .preview{width:500px;height:50px;margin-bottom:10px}.panelContent.EditCmdParams .contentWrapper .preview .el-input,.panelContent.EditCmdParams .contentWrapper .preview .select-trigger{height:100%}.panelContent.EditCmdParams .contentWrapper .preview .el-input__wrapper{background-color:var(--backgroundColor);box-shadow:none;padding:1px 5px;border-width:var(--borderWidth);border-color:var(--borderColor);border-style:solid}.panelContent.EditCmdParams .contentWrapper .preview .el-input__wrapper .el-input__inner,.panelContent.EditCmdParams .contentWrapper .preview .el-input__wrapper .el-select__caret{color:var(--fontColor)!important;font-size:var(--fontSize)!important;font-family:var(--fontFamily)!important;font-weight:var(--bolder);font-style:var(--italic);-webkit-text-decoration:var(--underline);text-decoration:var(--underline)}.panelContent.EditCmdParams .contentWrapper .preview .el-input__wrapper .el-input__inner{text-align:center;line-height:1.5;height:auto;text-align:var(--textAlign)}.panelContent.EditCmdParams .contentWrapper .preview .el-input__wrapper .el-input__inner::-moz-placeholder{color:var(--placeHolderColor)!important}.panelContent.EditCmdParams .contentWrapper .preview .el-input__wrapper .el-input__inner::placeholder{color:var(--placeHolderColor)!important}.panelContent.EditCmdParams .contentWrapper .preview .el-input__wrapper .el-select__caret{display:flex;justify-content:center;align-items:center;margin-left:0}",""]),a["default"]=i},64872:function(e,a,l){"use strict";l.r(a),l.d(a,{default:function(){return P}});var t=l(56768),n=l(24232);const o={class:"panelContent EditCmdParams"},r={class:"contentWrapper",ref:"contentWrapper"},i={class:"row"},d={class:"row"},p={class:"row"},u={class:"row"},m={class:"row"},s={class:"row"},c={key:0,class:"staticData"},f={key:0,class:"row"},b={class:"buttonWrapper"};function k(e,a,l,k,v,C){const g=(0,t.g2)("el-input"),F=(0,t.g2)("el-form-item"),h=(0,t.g2)("el-switch"),_=(0,t.g2)("el-input-number"),V=(0,t.g2)("el-checkbox"),D=(0,t.g2)("ColorPicker"),y=(0,t.g2)("el-divider"),w=(0,t.g2)("FontFamily"),x=(0,t.g2)("FontSizeEdit"),W=(0,t.g2)("el-button"),E=(0,t.g2)("el-tooltip"),P=(0,t.g2)("el-radio-button"),L=(0,t.g2)("el-radio-group"),U=(0,t.g2)("el-option"),z=(0,t.g2)("el-select"),I=(0,t.g2)("el-empty"),S=(0,t.g2)("SearchData"),O=(0,t.g2)("TableWrapper"),A=(0,t.g2)("el-form");return(0,t.uX)(),(0,t.CE)("div",o,[(0,t.Lk)("div",r,[(0,t.bF)(A,{class:"contentInner",ref:"editForm",model:k.formData,rules:k.rules,"label-width":"110px"},{default:(0,t.k6)(()=>[(0,t.Lk)("div",i,[(0,t.bF)(F,{class:"paramKey",label:"代號",prop:"paramKey"},{default:(0,t.k6)(()=>[(0,t.bF)(g,{modelValue:k.formData.paramKey,"onUpdate:modelValue":a[0]||(a[0]=e=>k.formData.paramKey=e)},{append:(0,t.k6)(()=>[...a[20]||(a[20]=[(0,t.eW)("$",-1)])]),prepend:(0,t.k6)(()=>[...a[21]||(a[21]=[(0,t.eW)("$",-1)])]),_:1},8,["modelValue"])]),_:1}),(0,t.bF)(F,{class:"noFlex",label:"只有管理者可視","label-width":"130px"},{default:(0,t.k6)(()=>[(0,t.bF)(h,{modelValue:k.formData.showInAdmin,"onUpdate:modelValue":a[1]||(a[1]=e=>k.formData.showInAdmin=e)},null,8,["modelValue"])]),_:1}),(0,t.bF)(F,{class:"defaultFirstOption",prop:"defaultOptionIndex"},{default:(0,t.k6)(()=>[(0,t.bF)(V,{modelValue:k.formData.defaultFirstOption,"onUpdate:modelValue":a[3]||(a[3]=e=>k.formData.defaultFirstOption=e),size:"large"},{default:(0,t.k6)(()=>[a[22]||(a[22]=(0,t.eW)("自動帶入第",-1)),(0,t.bF)(_,{modelValue:k.indexInput,"onUpdate:modelValue":a[2]||(a[2]=e=>k.indexInput=e),controls:!1,size:"small",min:1,onChange:k.changeIndexIpnut},null,8,["modelValue","onChange"]),a[23]||(a[23]=(0,t.eW)("個選項",-1))]),_:1},8,["modelValue"])]),_:1})]),(0,t.Lk)("div",d,[(0,t.bF)(F,{label:"提示字"},{default:(0,t.k6)(()=>[(0,t.bF)(g,{modelValue:k.formData.placeholder,"onUpdate:modelValue":a[4]||(a[4]=e=>k.formData.placeholder=e)},null,8,["modelValue"])]),_:1}),(0,t.bF)(F,{class:"noFlex",label:"提示字顏色"},{default:(0,t.k6)(()=>[(0,t.bF)(D,{modelValue:k.formData.placeHolderColor,"onUpdate:modelValue":a[5]||(a[5]=e=>k.formData.placeHolderColor=e)},null,8,["modelValue"])]),_:1})]),(0,t.bF)(y,{"content-position":"left"},{default:(0,t.k6)(()=>[...a[24]||(a[24]=[(0,t.Lk)("b",null,"樣式設定",-1)])]),_:1}),(0,t.Lk)("div",p,[(0,t.bF)(F,{label:"文字字型"},{default:(0,t.k6)(()=>[(0,t.bF)(w,{modelValue:k.formData.fontFamily,"onUpdate:modelValue":a[6]||(a[6]=e=>k.formData.fontFamily=e)},null,8,["modelValue"])]),_:1}),(0,t.bF)(F,{label:"文字大小"},{default:(0,t.k6)(()=>[(0,t.bF)(x,{modelValue:k.formData.fontSize,"onUpdate:modelValue":a[7]||(a[7]=e=>k.formData.fontSize=e)},null,8,["modelValue"])]),_:1})]),(0,t.Lk)("div",u,[(0,t.bF)(F,{class:"noFlex",label:"文字顏色"},{default:(0,t.k6)(()=>[(0,t.bF)(D,{modelValue:k.formData.fontColor,"onUpdate:modelValue":a[8]||(a[8]=e=>k.formData.fontColor=e)},null,8,["modelValue"])]),_:1}),(0,t.bF)(y,{direction:"vertical"}),(0,t.bF)(F,{class:"btn noFlex"},{default:(0,t.k6)(()=>[(0,t.bF)(E,{effect:"dark",content:"粗體",placement:"bottom"},{default:(0,t.k6)(()=>[(0,t.bF)(W,{style:{"font-weight":"bold"},class:(0,n.normalizeClass)({active:k.formData.bolder}),onClick:a[9]||(a[9]=()=>{k.formData.bolder=!k.formData.bolder})},{default:(0,t.k6)(()=>[...a[25]||(a[25]=[(0,t.eW)("B",-1)])]),_:1},8,["class"])]),_:1})]),_:1}),(0,t.bF)(F,{class:"btn noFlex"},{default:(0,t.k6)(()=>[(0,t.bF)(E,{effect:"dark",content:"斜體",placement:"bottom"},{default:(0,t.k6)(()=>[(0,t.bF)(W,{style:{"font-style":"italic"},class:(0,n.normalizeClass)({active:k.formData.italic}),onClick:a[10]||(a[10]=()=>{k.formData.italic=!k.formData.italic})},{default:(0,t.k6)(()=>[...a[26]||(a[26]=[(0,t.eW)("i",-1)])]),_:1},8,["class"])]),_:1})]),_:1}),(0,t.bF)(F,{class:"btn noFlex"},{default:(0,t.k6)(()=>[(0,t.bF)(E,{effect:"dark",content:"底線",placement:"bottom"},{default:(0,t.k6)(()=>[(0,t.bF)(W,{style:{"text-decoration":"underline"},class:(0,n.normalizeClass)({active:k.formData.underline}),onClick:a[11]||(a[11]=()=>{k.formData.underline=!k.formData.underline})},{default:(0,t.k6)(()=>[...a[27]||(a[27]=[(0,t.eW)("U",-1)])]),_:1},8,["class"])]),_:1})]),_:1}),(0,t.bF)(y,{direction:"vertical"}),(0,t.bF)(F,{class:"btn noFlex"},{default:(0,t.k6)(()=>[(0,t.bF)(L,{modelValue:k.formData.textAlign,"onUpdate:modelValue":a[12]||(a[12]=e=>k.formData.textAlign=e)},{default:(0,t.k6)(()=>[(0,t.bF)(P,{label:"left",title:"水平靠左"},{default:(0,t.k6)(()=>[...a[28]||(a[28]=[(0,t.Lk)("i",{class:"icon-paragraph-left"},null,-1)])]),_:1}),(0,t.bF)(P,{label:"center",title:"水平置中"},{default:(0,t.k6)(()=>[...a[29]||(a[29]=[(0,t.Lk)("i",{class:"icon-paragraph-center"},null,-1)])]),_:1}),(0,t.bF)(P,{label:"right",title:"水平靠右"},{default:(0,t.k6)(()=>[...a[30]||(a[30]=[(0,t.Lk)("i",{class:"icon-paragraph-right"},null,-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),(0,t.Lk)("div",m,[(0,t.bF)(F,{class:"noFlex",label:"選單顏色"},{default:(0,t.k6)(()=>[(0,t.bF)(D,{modelValue:k.formData.backgroundColor,"onUpdate:modelValue":a[13]||(a[13]=e=>k.formData.backgroundColor=e),"show-alpha":""},null,8,["modelValue"])]),_:1}),(0,t.bF)(F,{class:"noFlex",label:"選單邊框顏色"},{default:(0,t.k6)(()=>[(0,t.bF)(D,{modelValue:k.formData.borderColor,"onUpdate:modelValue":a[14]||(a[14]=e=>k.formData.borderColor=e),"show-alpha":""},null,8,["modelValue"])]),_:1}),(0,t.bF)(F,{label:"選單邊框寬度"},{default:(0,t.k6)(()=>[(0,t.bF)(g,{modelValue:k.formData.borderWidth,"onUpdate:modelValue":a[15]||(a[15]=e=>k.formData.borderWidth=e),modelModifiers:{number:!0},type:"number"},{append:(0,t.k6)(()=>[...a[31]||(a[31]=[(0,t.eW)("PX",-1)])]),_:1},8,["modelValue"])]),_:1})]),(0,t.bF)(y,{"content-position":"left"},{default:(0,t.k6)(()=>[...a[32]||(a[32]=[(0,t.Lk)("b",null,"預覽",-1)])]),_:1}),(0,t.bF)(z,{class:"preview",modelValue:k.test,"onUpdate:modelValue":a[16]||(a[16]=e=>k.test=e),placeholder:k.formData.placeholder,clearable:""},{default:(0,t.k6)(()=>[((0,t.uX)(),(0,t.CE)(t.FK,null,(0,t.pI)(4,e=>(0,t.bF)(U,{key:e,value:e,label:`選項${e}`},null,8,["value","label"])),64))]),_:1},8,["modelValue","placeholder"]),(0,t.bF)(y,{"content-position":"left"},{default:(0,t.k6)(()=>[(0,t.Lk)("div",s,[a[34]||(a[34]=(0,t.Lk)("b",null,"靜態資料",-1)),(0,t.bF)(W,{type:"primary",plain:"",size:"small",onClick:k.addStatic},{default:(0,t.k6)(()=>[...a[33]||(a[33]=[(0,t.Lk)("i",{class:"el-icon-plus"},null,-1)])]),_:1},8,["onClick"])])]),_:1}),k.staticData.length>0?((0,t.uX)(),(0,t.CE)("ul",c,[a[37]||(a[37]=(0,t.Lk)("div",{class:"row"},[(0,t.Lk)("p",null,"顯示值（label）"),(0,t.Lk)("p",null,"帶入值（value）")],-1)),((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(k.staticData,(e,l)=>((0,t.uX)(),(0,t.CE)("li",{key:l},[(0,t.bF)(g,{modelValue:e.label,"onUpdate:modelValue":a=>e.label=a,class:(0,n.normalizeClass)({error:!e.label})},null,8,["modelValue","onUpdate:modelValue","class"]),a[36]||(a[36]=(0,t.eW)("：",-1)),(0,t.bF)(g,{modelValue:e.value,"onUpdate:modelValue":a=>e.value=a,class:(0,n.normalizeClass)({error:!e.value})},null,8,["modelValue","onUpdate:modelValue","class"]),(0,t.bF)(W,{type:"danger",plain:"",size:"small",onClick:e=>k.deleteStatic(l)},{default:(0,t.k6)(()=>[...a[35]||(a[35]=[(0,t.Lk)("i",{class:"el-icon-close"},null,-1)])]),_:1},8,["onClick"])]))),128))])):((0,t.uX)(),(0,t.Wv)(I,{key:1,"image-size":100,description:"未輸入靜態資料"})),(0,t.bF)(y,{"content-position":"left"},{default:(0,t.k6)(()=>[...a[38]||(a[38]=[(0,t.Lk)("b",null,"動態資料 ",-1)])]),_:1}),(0,t.bF)(F,{class:"dataSource",label:"資料來源"},{default:(0,t.k6)(()=>[(0,t.bF)(S,{modelValue:k.formData.apiurl,"onUpdate:modelValue":a[17]||(a[17]=e=>k.formData.apiurl=e),onUpdate:k.getData},null,8,["modelValue","onUpdate"])]),_:1}),k.formData.apiurl?((0,t.uX)(),(0,t.CE)(t.FK,{key:2},[k.tableList.length>0?((0,t.uX)(),(0,t.CE)("div",f,[(0,t.bF)(F,{label:"顯示值(label)",prop:"paramSelect","label-width":"130px"},{default:(0,t.k6)(()=>[(0,t.bF)(z,{modelValue:k.formData.dynamicLabel,"onUpdate:modelValue":a[18]||(a[18]=e=>k.formData.dynamicLabel=e),clearable:""},{default:(0,t.k6)(()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(k.columnSetting,e=>((0,t.uX)(),(0,t.Wv)(U,{value:e.prop,label:e.label},null,8,["value","label"]))),256))]),_:1},8,["modelValue"])]),_:1}),(0,t.bF)(F,{label:"帶入值(value)",prop:"dynamicValue","label-width":"130px"},{default:(0,t.k6)(()=>[(0,t.bF)(z,{modelValue:k.formData.dynamicValue,"onUpdate:modelValue":a[19]||(a[19]=e=>k.formData.dynamicValue=e),clearable:""},{default:(0,t.k6)(()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(k.columnSetting,e=>((0,t.uX)(),(0,t.Wv)(U,{value:e.prop,label:e.label},null,8,["value","label"]))),256))]),_:1},8,["modelValue"])]),_:1})])):(0,t.Q3)("",!0),(0,t.bF)(O,{tableType:"small",tableHeight:k.tableHeight,tableWidth:k.tableWidth,tableData:k.tableList,columnSetting:k.columnSetting,listLoading:k.loading,showPagination:!1},null,8,["tableHeight","tableWidth","tableData","columnSetting","listLoading"])],64)):(0,t.Q3)("",!0)]),_:1},8,["model","rules"])],512),(0,t.Lk)("div",b,[(0,t.bF)(W,{type:"danger",onClick:k.closePanel},{default:(0,t.k6)(()=>[...a[39]||(a[39]=[(0,t.eW)("取消",-1)])]),_:1},8,["onClick"]),(0,t.bF)(W,{type:"success",onClick:k.checkValidate},{default:(0,t.k6)(()=>[...a[40]||(a[40]=[(0,t.Lk)("span",null,"儲存",-1)])]),_:1},8,["onClick"])])])}l(44114),l(18111),l(81148),l(7588),l(61701);var v=l(90144),C=l(78626),g=l(51219),F=l(4249),h=l(7118),_=l(43988),V=l(42497),D=l(77187),y=l(7681),w=l(51565),x={name:"EditCmdParams",components:{SearchData:_.A,FontFamily:V.A},props:{configProps:{type:Object,default:null}},setup(e,{emit:a}){const l=(0,F.Pj)(),n=(0,t.EW)(()=>e?e.configProps.info:{}),o=(0,v.ref)(null),r=(0,v.ref)(null),i=(0,v.ref)([]),d=(0,v.ref)(""),p=(0,v.reactive)({paramKey:"",apiurl:"",dynamicValue:"",dynamicLabel:"",fontColor:"",placeHolderColor:"",fontFamily:"",fontSize:"16px",showInAdmin:void 0,defaultFirstOption:void 0,defaultOptionIndex:0,backgroundColor:"",borderWidth:"",borderColor:"",bolder:!1,italic:!1,underline:!1,placeholder:"請選擇",textAlign:"center"}),u=(0,v.ref)(1),m=e=>{p.defaultOptionIndex=e-1},s=(0,v.ref)([]),c=(0,h.Q4)(p),f=(0,v.ref)(!1),b=(0,v.ref)([]),k=(0,v.ref)(0),_=(0,v.ref)(0),V=(0,t.EW)(()=>b.value[0]?Object.keys(b.value[0]).map(e=>({prop:e,label:e})):[]),x=()=>{a("close")},W=()=>{const e=s.value.every(e=>e.label&&e.value);e?r.value.validate(e=>{e&&E()}):(0,g.nk)({type:"error",message:"靜態資料未填寫完全"})},E=async()=>{const e=(0,C.cloneDeep)(n.value);p.apiurl||(p.apiurl=p.dynamicValue=p.dynamicLabel=""),Object.assign(e,{parameter:{...p,staticData:s.value},refreshApi:{time:0,isEnabled:!1}});try{let t,n="資料更新成功";if(e.id?t=await y.A.updatePartOf(e,e.id):(t=await y.A.addItem(e),n="資料新增成功"),(0,g.nk)({type:"success",message:n}),p.apiurl){const e=p.dynamicLabel?p.dynamicLabel:p.dynamicValue;t.listsData=i.value.map(a=>({label:a[e],value:a[p.dynamicValue]}))}else t.listsData=[];const o=t.parameter.defaultFirstOption,{staticData:r}=t.parameter,d=t.parameter.defaultOptionIndex,u=[...r,...t.listsData],m=u&&u[d]?u[d].value:"",s=o?m:"";l.dispatch("params/updateParams",{key:t.parameter.paramKey,value:s}),a("event-emit",{name:"refresh-page",props:t}),x()}catch{}},P=async e=>{f.value=!0;try{e?(i.value=await D.A.getData(e),b.value=i.value.length>5?i.value.slice(0,5):i.value):i.value=b.value=[]}catch{}finally{f.value=!1}},L=()=>{s.value.push({label:(0,v.ref)(""),value:(0,v.ref)("")})},U=e=>{s.value.splice(e,1)},z=()=>{const{parameter:e}=n.value;Object.keys(p).forEach(a=>{(e[a]||!1===e[a])&&(p[a]=(0,C.cloneDeep)(e[a]),"defaultOptionIndex"===a&&(u.value=p.defaultOptionIndex+1))}),e.staticData&&(s.value=e.staticData.map(e=>({label:(0,v.ref)(e.label),value:(0,v.ref)(e.value)}))),e.apiurl&&P(e.apiurl)},I=()=>{k.value=o.value.offsetHeight-400,_.value=o.value.offsetWidth-58+15};return(0,t.wB)(p,e=>{(0,w.L)(e,o)},{deep:!0}),(0,t.KC)(()=>{z()}),(0,t.sV)(()=>{I(),(0,w.L)(p,o)}),{formData:p,editForm:r,rules:c,closePanel:x,checkValidate:W,getData:P,contentWrapper:o,columnSetting:V,loading:f,tableHeight:k,tableWidth:_,tableList:b,addStatic:L,deleteStatic:U,staticData:s,indexInput:u,changeIndexIpnut:m,test:d}}},W=(l(78863),l(71241));const E=(0,W.A)(x,[["render",k]]);var P=E},78863:function(e,a,l){var t=l(48668);t.__esModule&&(t=t.default),"string"===typeof t&&(t=[[e.id,t,""]]),t.locals&&(e.exports=t.locals);var n=l(68459).A;n("150c3657",t,!0,{sourceMap:!1,shadowMode:!1})}}]);