(self["webpackChunkcontrol_center"]=self["webpackChunkcontrol_center"]||[]).push([[9598],{6861:function(e,a,t){"use strict";t.r(a);var n=t(31601),o=t.n(n),l=t(76314),r=t.n(l),i=r()(o());i.push([e.id,".panelContent .contentWrapper .row[data-v-4d043f7f]{justify-content:flex-start;align-items:center}.panelContent .contentWrapper .row .downloadExcel[data-v-4d043f7f]{margin:0 0 0 10px}",""]),a["default"]=i},12545:function(e,a,t){"use strict";t.d(a,{A:function(){return u}});var n=t(56768);function o(e,a,t,o,l,r){const i=(0,n.g2)("el-option"),s=(0,n.g2)("el-select");return(0,n.uX)(),(0,n.Wv)(s,{modelValue:o.mapPlace,"onUpdate:modelValue":a[0]||(a[0]=e=>o.mapPlace=e),filterable:"",remote:"","remote-show-suffix":"","remote-method":o.remoteMethod,"default-first-option":"",onChange:o.update},{default:(0,n.k6)(()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(o.mapList,e=>((0,n.uX)(),(0,n.Wv)(i,{key:e,value:e.abbreviation,label:`${e.chinese_name}(${e.english_name})`},null,8,["value","label"]))),128))]),_:1},8,["modelValue","remote-method","onChange"])}t(18111),t(22489);var l=t(90144),r=t(40192),i={name:"MapSelect",props:{modelValue:String},setup(e,{emit:a}){const t=(0,n.EW)(()=>e?e.modelValue:""),o=(0,l.ref)(t.value),i=(0,l.ref)([]),s=e=>{e||(i.value=r.A),i.value=r.A.filter(a=>{const t=`${a.chinese_name}(${a.english_name})`;return t.indexOf(e)>-1})},c=e=>{a("update:modelValue",e),a("update",e)};return(0,n.wB)(t,e=>{o.value=e}),(0,n.sV)(()=>{s("")}),{mapPlace:o,remoteMethod:s,mapList:i,update:c}}},s=t(71241);const c=(0,s.A)(i,[["render",o]]);var d=c,u=d},39598:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return b}});t(18111),t(61701);var n=t(56768);const o={class:"panelContent"},l={class:"contentWrapper"},r={class:"row"},i={class:"buttonWrapper"};function s(e,a,t,s,c,d){const u=(0,n.g2)("MapSelect"),p=(0,n.g2)("el-button"),m=(0,n.g2)("el-divider"),f=(0,n.g2)("highcharts"),h=(0,n.gN)("loading");return(0,n.uX)(),(0,n.CE)("div",o,[(0,n.Lk)("div",l,[(0,n.Lk)("div",r,[a[2]||(a[2]=(0,n.Lk)("p",null,"地圖選擇：",-1)),(0,n.bF)(u,{modelValue:s.formData.model,"onUpdate:modelValue":a[0]||(a[0]=e=>s.formData.model=e),onUpdate:s.getData},null,8,["modelValue","onUpdate"]),(0,n.bF)(p,{class:"downloadExcel",type:"warning",plain:"",onClick:s.download},{default:(0,n.k6)(()=>[...a[1]||(a[1]=[(0,n.Lk)("i",{class:"el-icon-download"},null,-1),(0,n.Lk)("span",null,"地名參數匯出",-1)])]),_:1},8,["onClick"])]),(0,n.bF)(m),s.map&&s.data&&s.highchartOptions.series[0].data?(0,n.bo)(((0,n.uX)(),(0,n.Wv)(f,{key:s.timeStamp,options:s.highchartOptions,constructorType:"mapChart"},null,8,["options"])),[[h,s.loading]]):(0,n.Q3)("",!0)]),(0,n.Lk)("div",i,[(0,n.bF)(p,{type:"danger",onClick:s.closePanel},{default:(0,n.k6)(()=>[...a[3]||(a[3]=[(0,n.eW)("取消",-1)])]),_:1},8,["onClick"])])])}t(22489),t(20116);var c=t(90144),d=t(51219),u=t(4235),p=t.n(u),m=t(40192),f=t(12545),h={name:"MapDemo",components:{MapSelect:f.A},setup(e,{emit:a}){const o=(0,c.ref)(!1),l=[{prop:"code",label:"代碼"},{prop:"name",label:"地名"}],r=(0,c.ref)(null),i=(0,c.ref)(null),s=(0,c.ref)([]),u=(0,c.ref)(""),f=(0,c.ref)(0),h=(0,c.reactive)({model:"World"}),v=(0,n.EW)(()=>({chart:{type:"map",map:i.value,zoomType:"xy",height:.95*window.innerHeight-240},navigation:{buttonOptions:{enabled:!1}},title:{text:`${u.value}-地圖預覽`},credits:{enabled:!1},accessibility:{enabled:!1},colorAxis:{visible:!1},series:[{data:r.value,joinBy:["hc-key","code"],name:"資料",dataLabels:{enabled:!0,format:"{point.code}"},tooltip:{headerFormat:"",pointFormat:"<b>{point.name} ({point.code})</b>"}}]})),g=async e=>{let a,n;if("World"===e)n=await t.e(1288).then(t.t.bind(t,74610,19)),a=n.default;else{const t=e.toLowerCase();try{o.value=!0,n=await fetch(`https://code.highcharts.com/mapdata/countries/${t}/${t}-all.geo.json`),a=await n.json()}catch{}finally{o.value=!1}}const l=m.A.find(a=>a.abbreviation===e);u.value=`${l.chinese_name}(${l.english_name})`,s.value=a.features.filter(e=>e.properties["hc-key"]).map(e=>({code:e.properties["hc-key"],name:e.properties.name})),r.value=a.features.filter(e=>e.properties["hc-key"]).map(e=>({value:Math.floor(1e3*Math.random()),code:e.properties["hc-key"]})).filter(e=>e.code),i.value=a,f.value=(new Date).getTime()},b=async()=>{try{const{downloadExcel:e}=p()({columnSetting:(0,c.ref)([l]),datas:(0,c.ref)([s.value]),fileName:`${u.value}-地名編碼`,sheetName:[`${u.value}-地名編碼`]});await e()}catch{(0,d.nk)({type:"error",message:"下載失敗"})}},k=()=>{a("close")};return(0,n.KC)(()=>{g(h.model)}),{highchartOptions:v,data:r,map:i,timeStamp:f,formData:h,getData:g,downloadList:s,mapName:u,columnSetting:l,download:b,loading:o,closePanel:k}}},v=(t(55298),t(71241));const g=(0,v.A)(h,[["render",s],["__scopeId","data-v-4d043f7f"]]);var b=g},55298:function(e,a,t){var n=t(6861);n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);var o=t(68459).A;o("3fc5ba3a",n,!0,{sourceMap:!1,shadowMode:!1})}}]);