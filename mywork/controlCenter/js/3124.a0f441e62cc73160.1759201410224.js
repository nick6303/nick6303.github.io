(self["webpackChunkcontrol_center"]=self["webpackChunkcontrol_center"]||[]).push([[3124],{3124:function(e,l,a){"use strict";a.r(l),a.d(l,{default:function(){return y}});var t=a(56768),o=a(24232);const r={class:"panelContent"},n={class:"contentWrapper"},s=["innerHTML"],i={class:"buttonWrapper"};function c(e,l,a,c,u,d){const p=(0,t.g2)("el-button"),f=(0,t.g2)("el-upload"),m=(0,t.g2)("el-form-item"),k=(0,t.g2)("ColorPicker"),v=(0,t.g2)("el-form"),b=(0,t.g2)("Gallery");return(0,t.uX)(),(0,t.CE)("div",r,[(0,t.Lk)("div",n,[(0,t.bF)(v,{class:"contentInner",ref:"editForm",model:c.formData,rules:c.rules},{default:(0,t.k6)(()=>[(0,t.bF)(m,{class:"upload",label:"檔案上傳"},{default:(0,t.k6)(()=>[(0,t.bF)(f,{action:"","http-request":c.uploadAction,"before-upload":c.beforeUpload,"show-file-list":!1},{default:(0,t.k6)(()=>[(0,t.bF)(p,{size:"small",type:"primary"},{default:(0,t.k6)(()=>[...l[1]||(l[1]=[(0,t.Lk)("i",{class:"el-icon-upload2"},null,-1),(0,t.Lk)("span",null,"自行上傳",-1)])]),_:1})]),_:1},8,["http-request","before-upload"]),(0,t.bF)(p,{size:"small",onClick:c.openGallery},{default:(0,t.k6)(()=>[...l[2]||(l[2]=[(0,t.Lk)("i",{class:"el-icon-menu"},null,-1),(0,t.Lk)("span",null,"從圖庫",-1)])]),_:1},8,["onClick"])]),_:1}),(0,t.bF)(m,{label:"圖片顏色"},{default:(0,t.k6)(()=>[(0,t.bF)(k,{modelValue:c.formData.parameter.fillColor,"onUpdate:modelValue":l[0]||(l[0]=e=>c.formData.parameter.fillColor=e),"show-alpha":""},null,8,["modelValue"])]),_:1}),c.formData.parameter.svgData?((0,t.uX)(),(0,t.Wv)(m,{key:0,class:"preview",label:"圖片預覽"},{default:(0,t.k6)(()=>[(0,t.Lk)("div",{class:"svgBlock",innerHTML:c.formData.parameter.svgData,style:(0,o.normalizeStyle)({color:c.formData.parameter.fillColor})},null,12,s)]),_:1})):(0,t.Q3)("",!0)]),_:1},8,["model","rules"])]),(0,t.Lk)("div",i,[(0,t.bF)(p,{type:"danger",onClick:c.closePanel},{default:(0,t.k6)(()=>[...l[3]||(l[3]=[(0,t.eW)("取消",-1)])]),_:1},8,["onClick"]),(0,t.bF)(p,{type:"success",onClick:c.checkValidate},{default:(0,t.k6)(()=>[...l[4]||(l[4]=[(0,t.Lk)("span",null,"儲存",-1)])]),_:1},8,["onClick"])]),(0,t.bF)(b,{ref:"galleryRef",onSubmitGallery:c.submitGallery},null,8,["onSubmitGallery"])])}a(18111),a(7588);var u=a(90144),d=a(7118),p=a(78626),f=a(51219),m=a(7681),k=a(299),v={name:"EditSvgBlock",components:{Gallery:k.A},props:{configProps:{type:Object,default:null}},setup(e,{emit:l}){const a=(0,t.EW)(()=>e?e.configProps.info:{}),o=(0,u.ref)(!1),r=(0,u.ref)(null),n=(0,u.ref)(null),s=(0,u.reactive)({title:"",parameter:{fillColor:"",svgData:""}}),i=(0,d.Q4)(s),c=()=>{n.value.open()},k=()=>{r.value.validate(e=>{e&&v()})},v=async()=>{const e=(0,p.cloneDeep)(a.value);Object.assign(e,{...s,refreshApi:{time:0,isEnabled:!1}});try{let a,t="資料更新成功";e.id?a=await m.A.updatePartOf(e,e.id):(a=await m.A.addItem(e),t="資料新增成功"),(0,f.nk)({type:"success",message:t}),l("event-emit",{name:"refresh-page",props:a}),b()}catch{}},b=()=>{l("close")},g=e=>{const{file:l}=e;s.title=l.name;const a=new FileReader;a.onload=function(e){const l=e.target.result;s.parameter.svgData=l},a.readAsText(l)},y=e=>{const l="image/svg+xml",a=l.indexOf(e.type)>-1;if(!a)return(0,f.nk)({message:"僅能上傳 SVG 圖片",type:"error"}),!1},h=({file:e})=>{g({file:e})},_=()=>{Object.keys(s).forEach(e=>{a.value[e]&&(s[e]=(0,p.cloneDeep)(a.value[e]))})};return(0,t.KC)(()=>{_()}),{closePanel:b,loading:o,editForm:r,rules:i,formData:s,checkValidate:k,uploadAction:g,beforeUpload:y,openGallery:c,submitGallery:h,galleryRef:n}}},b=(a(49847),a(71241));const g=(0,b.A)(v,[["render",c],["__scopeId","data-v-15045bed"]]);var y=g},23540:function(e,l,a){"use strict";a.r(l);var t=a(31601),o=a.n(t),r=a(76314),n=a.n(r),s=n()(o());s.push([e.id,".upload[data-v-15045bed] .el-form-item__content{display:flex;align-items:center}.upload[data-v-15045bed] .el-form-item__content .el-upload{margin:0 10px 0 0}.preview[data-v-15045bed]{display:flex;align-items:flex-start}.svgBlock[data-v-15045bed]{width:100px;height:100px}.svgBlock[data-v-15045bed] svg{width:100%;height:100%;fill:currentColor}",""]),l["default"]=s},49847:function(e,l,a){var t=a(23540);t.__esModule&&(t=t.default),"string"===typeof t&&(t=[[e.id,t,""]]),t.locals&&(e.exports=t.locals);var o=a(68459).A;o("591d89d8",t,!0,{sourceMap:!1,shadowMode:!1})}}]);